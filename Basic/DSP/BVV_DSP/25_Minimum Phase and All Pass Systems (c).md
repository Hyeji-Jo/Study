# 최소 위상 시스템 (Minimum Phase System)

![image](https://github.com/user-attachments/assets/99a43e0f-fa1b-4a44-9de0-eabc8a1e01a9)

## 정의
- 안정적(stable)이고 인과적(causal)인 시스템이 안정적이고 인과적인 역(inverse)을 가지기 위한 **충분 조건**
  - 모든 극점(poles)과 영점(zeros)이 $|z| = 1$ **안쪽에 위치**해야 합니다
  - 이러한 시스템을 **최소 위상 시스템(Minimum Phase System)**이라고 부릅니다

## 특징
1. **최소 위상 시스템의 위상 지연(Phase Lag)**
   - 모든 극점과 영점이 $|z|=1$ 내부에 위치할 경우, 해당 시스템의 위상 지연은 동일한 크기 응답(Magnitude Response)을 가지는 다른 시스템보다 **작습니다**.

2. **응용**
   - 최소 위상 시스템은 위상 왜곡을 최소화해야 하는 신호 처리 응용 분야에서 유용합니다.
   - 안정성과 인과성을 유지하면서도 **효율적인 시스템 설계**가 가능합니다.

## 요약
- 안정적, 인과적 시스템이 역 시스템을 가지려면 **최소 위상 시스템**이어야 합니다
- 위상 왜곡이 적고, 시스템 설계에 중요한 특성을 제공합니다

# 합리적 시스템 함수의 구성
![image](https://github.com/user-attachments/assets/6ae63b82-5b2f-4ab8-84cc-2cba20d189dd)

## 1. 시스템 함수 분해

- 임의의 합리적 시스템 함수 $\(H(z)\)$는 다음과 같이 두 부분으로 나눌 수 있습니다
  - $\[ H(z) = H_{\text{min}}(z) \cdot H_{\text{ap}}(z) \]$
  - $\(H_{\text{min}}(z)\)$: 최소 위상(Minimum Phase) 부분
  - $\(H_{\text{ap}}(z)\)$: 전역 통과(All Pass) 부분

### 전역 통과(All Pass)
- 전역 통과 시스템의 크기 응답(Magnitude Response)은 모든 주파수에서 1로 유지됩니다
  - $\[ |H_{\text{ap}}(e^{j\omega})| = 1 \]$
- 전역 통과 시스템의 특징
  - 극점(Poles)과 영점(Zeros)이 **켤레 역수 쌍(Conjugate Reciprocal Pairs)**으로 나타납니다
 
## 2. 전역 통과 시스템의 수식
- 전역 통과 부분 $\(H_{\text{ap}}(z)\)$는 다음과 같이 표현됩니다
  - $\[ H_{\text{ap}}(z) = \prod_{i=1}^{P} \frac{z^{-1} - c_i^*}{1 - c_i z^{-1}} \]$
  - 극점: $\(c_i = r e^{j\phi}\)$
  - 영점: $\(c_i^* = \frac{1}{r} e^{-j\phi}\)$

## 3. 주파수 응답의 해석
- 극점과 영점의 분포는 $|z|=1$을 기준으로 대칭적입니다
- 이러한 대칭성은 시스템의 위상을 제어하면서 크기 응답을 유지하는 데 사용됩니다

## 그림 해석
- 극점 $\(c_i\)$와 영점 $\(c_i^*\)$는 $|z|=1$을 기준으로 대칭입니다
- $\(H_{\text{ap}}(z)\)$는 위상만 조정하고 크기 응답은 변화시키지 않습니다

# 전역 통과 시스템의 크기 응답 증명
![image](https://github.com/user-attachments/assets/dc5fa84e-a71a-490f-bf18-ab00f38acf83)

## 증명 목표

- 전역 통과 시스템의 크기 응답이 모든 주파수에서 1임을 보이기:$\[ |H_{\text{ap}}(e^{j\omega})| = 1 \]$


## 계산 과정
- 전역 통과 시스템의 식에서 $P=1$인 경우를 고려합니다
- $\[ H_{\text{ap}}(e^{j\omega}) = \frac{e^{-j\omega} - c^*}{1 - c e^{-j\omega}} \]$

### 크기 계산
- $\[ |H_{\text{ap}}(e^{j\omega})| = \left| \frac{e^{-j\omega} - c^*}{1 - c e^{-j\omega}} \right| \]$

- 분모와 분자를 별도로 계산합니다
  1. 분자: $\[ e^{-j\omega} - c^* \]$
  2. 분모: $\[ 1 - c e^{-j\omega} \]$

- 이를 크기 계산에 대입하면
  - $\[ |H_{\text{ap}}(e^{j\omega})| = \frac{|e^{-j\omega} - c^*|}{|1 - c e^{-j\omega}|} \]$

## 크기 응답의 특성
- 분자와 분모의 크기를 계산한 결과:$\[ |e^{-j\omega} - c^*| = |1 - c e^{-j\omega}| \]$
- 따라서:$\[ |H_{\text{ap}}(e^{j\omega})| = \frac{|e^{-j\omega} - c^*|}{|1 - c e^{-j\omega}|} = 1 \]$

## 결론
- 모든 주파수에서 전역 통과 시스템의 크기 응답은 1로 유지됩니다
- $\[ |H_{\text{ap}}(e^{j\omega})| = 1 \]$

## 추가 설명
- **극점과 영점의 대칭성**
  - 극점($c$)과 영점($c^*$)이 $|z|=1$을 기준으로 대칭이기 때문에 이러한 결과가 성립합니다
- **의미**
  - 전역 통과 시스템은 위상을 조정하지만, 크기 응답은 변하지 않습니다

# Example: All-Pass System

![image](https://github.com/user-attachments/assets/96cf381c-2209-41d5-b6fb-d0c08f591f66)

## 주어진 시스템
- $\[ H(z) = \frac{z^{-1} - c^*}{1 - c z^{-1}} \]$
- **극점(pole)**: $c$
- **영점(zero)**: $c^*$ (극점의 켤레 복소수)
- **특성**: 모든 주파수에서 크기 응답 $|H(e^{j\omega})| = 1$로 유지

## 시스템의 분석

### 1. 극점과 영점의 위치
- 극점 $c = 0.9$와 영점 $c^* = 0.9$는 단위 원($|z|=1$) 안팎에 대칭적으로 위치합니다
- $|H(e^{j\omega})|$는 모든 주파수에서 항상 1로 유지됩니다

### 2. 크기 응답
- $\[ |H(e^{j\omega})| = 1 \]$
- 이는 주파수 영역에서 모든 주파수에 대해 크기가 동일하다는 것을 의미합니다

### 3. 위상 응답
- $c = 0.9$: 위상 응답은 음의 증가를 보이며, 약 $-180^\circ$에 근접합니다
- $c = -0.9$: 위상 응답이 반대로 양의 증가를 보입니다

## 플롯 설명
1. **왼쪽 상단**: 극점과 영점의 위치
    - 극점 $c = 0.9$
    - 영점 $c^* = 0.9$
2. **오른쪽 상단**: 크기 응답
    - 모든 주파수에서 $|H(e^{j\omega})| = 1$로 일정함
3. **왼쪽 하단**: $c = 0.9$에 대한 위상 응답
    - 위상 변화가 음의 방향으로 점진적으로 증가
4. **오른쪽 하단**: $c = -0.9$에 대한 위상 응답
    - 위상 변화가 양의 방향으로 점진적으로 증가

## 요약

- **전역 통과 시스템의 특징**
  - 크기 응답은 항상 1로 일정합니다
  - 위상 응답은 극점과 영점의 위치에 따라 다릅니다
  - 극점과 영점은 대칭적으로 위치하며, 시스템의 위상 변화를 조정합니다

 
# H(z)를 $H_{\text{min}}(z)$와 $H_{\text{ap}}(z)$로 분해하기
![image](https://github.com/user-attachments/assets/22b23e33-6b83-4fb7-aaff-23b283ff74b6)

## 분해 과정
1. **단위 원($|z|=1$) 바깥에 있는 영점(zero)을 찾아서 $H_{\text{ap}}(z)$로 이동**
   - $|z| > 1$인 영점 $\beta$를 찾아 이동

2. **$H_{\text{ap}}(z)$에 이동된 영점의 켤레 반전 위치에 극점(pole)을 추가**
   - 이동된 $\beta$를 단위 원의 내부로 반사(켤레 반전)하여 $H_{\text{ap}}(z)$에 극점을 추가

3. **$H_{\text{min}}(z)$에 $H_{\text{ap}}(z)$에 추가된 극점과 상쇄되는 영점을 추가**
   - $H_{\text{ap}}(z)$에 추가된 극점에 대응하여 $H_{\text{min}}(z)$에 상쇄되는 영점을 설정

## 예제: $H(z)$ 분해
- $\[ H(z) = H_1(z) (1 - \beta z^{-1}) \]$
- $\[ |\beta| > 1 \]$인 경우, $H_1(z)$는 최소 위상(minimum phase)을 가지며, $H_{\text{ap}}(z)$를 추가하여 분해를 진행.

### 단계 1
- $\[ H(z) = H_1(z)(z^{-1} - \frac{1}{\beta}) \]$
- $H_{\text{ap}}(z)$로 이동된 영점: $z^{-1} - \frac{1}{\beta}$

### 단계 2+3
- $\[ H(z) = H_1(z)(1 - \beta z^{-1})(z^{-1} - \frac{1}{\beta}) \]$
- $H_{\text{min}}(z)$: $\[ (1 - \beta z^{-1}) \]$
- $H_{\text{ap}}(z)$: $\[ (z^{-1} - \frac{1}{\beta}) \]$

## 최종 분해 결과
- $\[ H(z) = H_{\text{min}}(z) H_{\text{ap}}(z) \]$

- **$H_{\text{min}}(z)$**:$\[ H_{\text{min}}(z) = (1 - \beta z^{-1}) \]$
- **$H_{\text{ap}}(z)$**:$\[ H_{\text{ap}}(z) = (z^{-1} - \frac{1}{\beta}) \]$

## 시각적 설명

- $H(z)$의 영점 $\beta$는 단위 원($|z|=1$) 바깥에 있으며, 이를 단위 원 내부로 반사하여 $H_{\text{ap}}(z)$에 극점으로 추가
- $H_{\text{min}}(z)$는 최소 위상 시스템으로, 단위 원 내부에만 극점과 영점을 포함.

## 요약

1. $H(z)$는 최소 위상 성분($H_{\text{min}}(z)$)과 전역 통과 성분($H_{\text{ap}}(z)$)의 곱으로 분해
2. 전역 통과 성분($H_{\text{ap}}(z)$)은 단위 원 바깥의 영점을 반사하여 극점을 추가하여 구성
3. 최소 위상 성분($H_{\text{min}}(z)$)은 단위 원 내부에만 영점과 극점을 포함

# 최소 위상 시스템(Minimum Phase System)의 특성과 역시스템(Inverse System)

![image](https://github.com/user-attachments/assets/5d05f42a-0841-468f-a38e-2f9f6ce2e9b5)

## 개요

- 최소 위상 부분($H_{\text{min}}(z)$)을 가지는 시스템은 **안정적(stable)**이고 **인과적(causal)**인 **역시스템**을 가질 수 있다.

- $H(z)$를 최소 위상 성분($H_{\text{min}}(z)$)과 전역 통과 성분($H_{\text{ap}}(z)$)으로 분해 가능
  - $\[ H(z) = H_{\text{min}}(z) H_{\text{ap}}(z) \]$


## 주요 내용

1. **최소 위상 시스템의 역시스템**
   - $H_{\text{min}}(z)$는 안정적(stable)이고 인과적(causal)인 역시스템:$\[ H_{\text{min}}(z)^{-1} \]$
   - $H(z)$의 역시스템:$\[ H(z)^{-1} = H_{\text{ap}}(z)^{-1} H_{\text{min}}(z)^{-1} \]$

2. **전역 통과 성분($H_{\text{ap}}(z)$)**
   - $H_{\text{ap}}(z)$는 크기 왜곡(magnitude distortion)을 유발하지 않으며, **위상 왜곡(phase distortion)**만 존재.

## 흐름도

- **입력 신호($x[n]$)**는 시스템 $H(z)$를 거쳐 출력 신호 $y[n]$ 생성
- 최소 위상 시스템의 역시스템($1/H_{\text{min}}(z)$)을 적용하여 왜곡된 신호를 복원
  - **복원된 신호**: $\[ \tilde{x}[n] \]$
- 전역 통과 성분($H_{\text{ap}}(z)$)은 크기 왜곡 없이 위상 왜곡만 적용

## 요약

1. **최소 위상 성분**($H_{\text{min}}(z)$)은 안정적(stable)이고 인과적(causal)인 역시스템을 가진다
2. **전역 통과 성분**($H_{\text{ap}}(z)$)은 크기 왜곡이 없으며, 위상 왜곡만 존재
3. 시스템 전체($H(z)$)의 역시스템은 $H_{\text{min}}(z)$와 $H_{\text{ap}}(z)$의 성질을 결합하여 복원 가능


## 시각적 설명

- **최소 위상 성분**의 역시스템: 왜곡 신호를 안정적이고 인과적으로 복원
- **전역 통과 성분**: 신호의 위상에만 영향을 미침

# 예제: 시스템 $H(z)$의 최소 위상 및 전역 통과 성분 분해
![image](https://github.com/user-attachments/assets/f7f2eee1-8061-4c96-8954-ed1e653d35fe)

## 주어진 시스템

- 시스템의 전달 함수:$\[ H(z) = (1 - \frac{1}{2}z^{-1})(1 + \frac{1}{2}z^{-1})(1 - jz^{-1})(1 + jz^{-1}) \]$


## 분석 과정

1. **$H(z)$의 최소 위상 성분과 전역 통과 성분 분리**
   - 전역 통과 성분($H_{\text{ap}}(z)$):$\[ H_{\text{ap}}(z) = \frac{(z^{-1} - 0.9)(z^{-1} + 0.9)}{(1 - 0.9z^{-1})(1 + 0.9z^{-1})} \]$
   - 최소 위상 성분($H_{\text{min}}(z)$):$\[ H_{\text{min}}(z) = \frac{(1 - 0.9z^{-1})(1 + 0.9z^{-1})(1 - jz^{-1})(1 + jz^{-1})}{(z^{-1} - 0.9)(z^{-1} + 0.9)} \]$

2. **그래프 및 시각적 분석**
   - $H(z)$의 크기와 위상
     - 그래프에서 시스템의 크기와 위상 변화를 확인
   - $H_{\text{ap}}(e^{j\omega})$
     - 전역 통과 성분의 크기는 일정하고 위상 변화만 있음

## 결과
- **$H_{\text{ap}}(z)$**: 크기 왜곡 없이 위상 왜곡만 유발하는 전역 통과 성분
- **$H_{\text{min}}(z)$**: 안정적(stable)이고 인과적(causal)인 시스템으로, 복원이 가능

## 요약

- $H(z)$는 $H_{\text{min}}(z)$와 $H_{\text{ap}}(z)$로 분해 가능:$\[ H(z) = H_{\text{min}}(z) H_{\text{ap}}(z) \]$
- 최소 위상 성분($H_{\text{min}}(z)$)은 안정적이고 인과적인 반면, 전역 통과 성분($H_{\text{ap}}(z)$)은 위상 왜곡만 유발


## 추가 정보
- 최소 위상 성분($H_{\text{min}}(z)$)의 역시스템($H_{\text{min}}(z)^{-1}$)을 통해 신호 복원이 가능
- 전역 통과 성분($H_{\text{ap}}(z)$)은 위상 왜곡만 유발하며 신호 복원에 영향을 미치지 않음
