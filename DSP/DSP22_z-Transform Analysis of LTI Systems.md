# LTI 시스템과 차분 방정식
![image](https://github.com/user-attachments/assets/779f1636-2135-45aa-8d18-5648e089b392)

## 개요
- LTI (Linear Time-Invariant) 시스템은 차분 방정식으로 표현되며, 신호 처리에서 중요한 역할을 합니다.
- 이러한 시스템은 다음과 같은 두 가지 주요 응용 분야를 가집니다.

## 1. 필터 (Filters)
### 설명
- 필터는 시스템의 응답에 따라 **무한 임펄스 응답 (IIR)** 또는 **유한 임펄스 응답 (FIR)**으로 분류됩니다
  - **IIR**: 무한히 긴 임펄스 응답을 가짐
  - **FIR**: 유한한 임펄스 응답을 가짐

### 주요 작업
1. **필터 설계 (Filter Design)**
   - 주어진 신호의 특정 주파수 대역을 강조하거나 제거하기 위해 설계됩니다
2. **필터 구현 (Filter Implementation)**
   - 설계된 필터를 실제 시스템 또는 소프트웨어로 구현합니다

## 2. 모델 (Models)
### 설명
LTI 시스템은 다음 두 가지 유형의 모델링에 사용됩니다
1. **왜곡을 도입하는 시스템 모델링**
   - 시스템이 신호에 왜곡을 도입하는 과정을 모델링합니다
   - 예: 통신 시스템에서 채널 왜곡
2. **랜덤 프로세스의 특성을 모델링**
   - 랜덤 신호의 통계적 특성을 이해하고 모델링합니다
   - 예: 잡음 모델링, 신호의 자기상관 함수 모델링

## 요약
- **필터**는 신호를 변환하거나 원하는 특성을 추출하는 데 사용됩니다
- **모델**은 시스템의 왜곡 효과를 분석하거나 랜덤 신호의 특성을 이해하는 데 사용됩니다
- LTI 시스템은 신호 처리의 핵심적인 역할을 하며, 다양한 응용 분야에서 필수적인 도구로 사용됩니다

# 일반 형태와 시스템 전달 함수
![image](https://github.com/user-attachments/assets/26d0a57d-a0f2-4e87-8d5f-3e48fffb7e0e)

## 일반 형태 (General Form)

### 설명
- **LTI 시스템**은 입력 신호와 출력 신호 간의 관계를 차분 방정식으로 나타낼 수 있습니다
- 이 관계는 다음과 같은 일반 형태로 표현됩니다:$\[ \sum_{k=0}^{N} a_k y[n-k] = \sum_{k=0}^{M} b_k x[n-k], \quad a_0 \neq 0 \]$

## Z-변환을 통한 표현

### 출력 신호의 Z-변환
- 양쪽에 Z-변환을 적용하면
  - $\[ \sum_{k=0}^{N} a_k z^{-k} Y(z) = \sum_{k=0}^{M} b_k z^{-k} X(z) \]$
- 따라서
  - $\[ Y(z) = \frac{\sum_{k=0}^{M} b_k z^{-k}}{\sum_{k=0}^{N} a_k z^{-k}} X(z) \]$

## 시스템 전달 함수 $H(z)$
### 정의
- **전달 함수 (Transfer Function)**는 다음과 같이 정의됩니다
  - $\[ H(z) = \frac{\sum_{k=0}^{M} b_k z^{-k}}{\sum_{k=0}^{N} a_k z^{-k}} \]$

### 분해
- 전달 함수를 다음과 같이 분해할 수 있습니다
  - $\[ H(z) = \frac{b_0}{a_0} \cdot \frac{\prod_{k=1}^{M} (1 - c_k z^{-1})}{\prod_{k=1}^{N} (1 - d_k z^{-1})} \]$
- 여기서
  - $c_k$: 영점 (zeros)
  - $d_k$: 극점 (poles)

### 가정
- $b_0 \neq 0$임을 가정

## 요약
- **일반 형태**는 입력과 출력 간의 관계를 차분 방정식으로 나타냅니다
- **Z-변환**을 사용하여 전달 함수 $H(z)$로 변환하면 시스템의 특성을 분석할 수 있습니다
- 전달 함수는 영점 ($c_k$)과 극점 ($d_k$)을 통해 시스템의 주파수 응답을 이해하는 데 도움을 줍니다


# 예제: 주어진 $H(z)$로부터 차분 방정식 구하기
![image](https://github.com/user-attachments/assets/757b22b3-9713-4a25-bf6d-8cb874ad8176)

## 주어진 $\(H(z)\)$
- $\[ H(z) = \frac{(z+1)^2}{(z - \frac{1}{2})(z + \frac{1}{4})} \]$


## 단계별 풀이

### 1. $\(z^{-1}\)$ 형태로 표현
- 분모와 분자를 $\(z^{-1}\)$ 형태로 변환
  - $\[ H(z) = \frac{z^2(1 + z^{-1})^2}{z^2 \left(1 - \frac{1}{2}z^{-1}\right)\left(1 + \frac{1}{4}z^{-1}\right)} \]$

### 2. 항의 곱셈
- 분자의 $\( (1 + z^{-1})^2 \)$ 전개:$\[ (1 + z^{-1})^2 = 1 + 2z^{-1} + z^{-2} \]$

- 분모의 전개:$\[ \left(1 - \frac{1}{2}z^{-1}\right)\left(1 + \frac{1}{4}z^{-1}\right) = 1 - \frac{1}{4}z^{-1} - \frac{1}{8}z^{-2} \]$

- 최종적으로:$\[ H(z) = \frac{1 + 2z^{-1} + z^{-2}}{1 - \frac{1}{4}z^{-1} - \frac{1}{8}z^{-2}} \]$

### 3. 계수 도출
- **영점 (zeros)**: $\(z = -1\)$ (중복 2번)
- **극점 (poles)**: $\(z = \frac{1}{2}, z = -\frac{1}{4}\)$
- **계수**
  - $\(b_0 = 1, b_1 = 2, b_2 = 1\)$
  - $\(a_0 = 1, a_1 = -\frac{1}{4}, a_2 = -\frac{1}{8}\)$

### 4. 차분 방정식 도출
- $\(H(z)\)$는 다음과 같은 방정식을 만족합니다
  - $\[ y[n] - \frac{1}{4}y[n-1] - \frac{1}{8}y[n-2] = x[n] + 2x[n-1] + x[n-2] \]$


## 설명
- $\(H(z)\)$를 $\(z^{-1}\)$ 형태로 변환함으로써 입력 $\(x[n]\)$과 출력 $\(y[n]\)$의 관계를 직접적으로 나타낼 수 있는 차분 방정식을 도출했습니다
- 영점과 극점은 시스템의 안정성과 응답을 분석하는 데 중요한 역할을 합니다


# 주요 질문 (Key Questions)
![image](https://github.com/user-attachments/assets/78aae535-7c03-47d0-afbb-1c3059d117be)

## 1. 안정적인 시스템의 조건은 무엇인가? (What are the conditions for a stable system?)
- 시스템이 **안정적**이려면 모든 극점이 단위 원 **내부**에 위치해야 합니다
- 이는 시간 영역에서 출력 신호가 발산하지 않고 수렴한다는 것을 의미합니다

## 2. 인과적인 시스템의 조건은 무엇인가? (What are the conditions for a causal system?)
- 시스템이 **인과적**이려면 출력 $\(y[n]\)$은 현재 또는 과거의 입력 $\(x[n]\)$에만 의존해야 합니다
- **$z$-영역에서** ROC(Region of Convergence)는 극점의 **외부**에 위치해야 합니다

## 3. $\(H(z)\)$가 왜곡을 유발하는 시스템의 모델이라면, 이를 복원할 수 있는가?  
- (If $\(H(z)\)$ is a model for a system that introduces distortion, can it be reversed?)

- 왜곡된 신호를 복원하려면 $\(H(z)\)$의 **역함수 $\(H^{-1}(z)\)$** 를 설계해야 합니다
- 예
  - 통신 채널을 $\(H(z)\)$로 모델링하고, 출력 신호가 왜곡되었다고 가정합니다
  - $\(H^{-1}(z)\)$를 적용하여 원래 신호를 복원할 수 있습니다

## 4. 차분 방정식의 매개변수와 주파수 응답은 어떻게 관련이 있는가?  
- (How does the frequency response relate to the parameters of the difference equation?)

- 차분 방정식의 계수는 시스템의 **극점(poles)**과 **영점(zeros)**을 결정합니다
- 극점과 영점의 위치는 주파수 응답의 **크기**와 **위상** 특성을 정의합니다
- 예
  - 극점은 특정 주파수에서 시스템의 에너지를 증폭 또는 감쇠합니다
  - 영점은 특정 주파수를 차단하거나 약화시킵니다
 
### 그림 설명
1. **통신 채널 $\(H(z)\)$**
   - 입력 신호를 왜곡시킴
2. **복원 필터 $\(H^{-1}(z)\)$**
   - $\(H(z)\)$의 역 필터를 적용하여 왜곡된 신호를 복원
  

